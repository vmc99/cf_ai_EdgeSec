{
  "name": "analyze_traffic_pattern",
  "description": "Parse log samples and identify security anomalies like DDoS, SQL injection, path traversal, bot spikes. Returns threat classification with confidence score.",
  "input_schema": {
    "type": "object",
    "properties": {
      "logs": {
        "type": "array",
        "minItems": 1,
        "maxItems": 10000,
        "description": "Array of log entries to analyze",
        "items": {
          "type": "object",
          "properties": {
            "timestamp": {
              "type": "string",
              "format": "date-time",
              "description": "Request timestamp (ISO 8601)"
            },
            "clientIP": {
              "type": "string",
              "description": "Client IP address"
            },
            "path": {
              "type": "string",
              "description": "Request path"
            },
            "method": {
              "type": "string",
              "enum": ["GET", "POST", "PUT", "DELETE", "PATCH", "HEAD", "OPTIONS"],
              "description": "HTTP method"
            },
            "statusCode": {
              "type": "integer",
              "minimum": 100,
              "maximum": 599,
              "description": "HTTP status code"
            },
            "userAgent": {
              "type": "string",
              "description": "User agent string"
            },
            "country": {
              "type": "string",
              "pattern": "^[A-Z]{2}$",
              "description": "Country code (ISO 3166-1 alpha-2)"
            },
            "asn": {
              "type": "string",
              "description": "Autonomous System Number"
            },
            "query": {
              "type": "string",
              "description": "Query string parameters"
            }
          },
          "required": ["timestamp", "clientIP", "path", "method", "statusCode"]
        }
      },
      "timeWindow": {
        "type": "string",
        "pattern": "^[0-9]+(s|m|h|d)$",
        "description": "Time window for analysis (e.g., '5m', '1h', '1d')",
        "default": "10m"
      },
      "sensitivityLevel": {
        "type": "string",
        "enum": ["low", "medium", "high"],
        "description": "Anomaly detection sensitivity",
        "default": "medium"
      }
    },
    "required": ["logs"]
  },
  "output_schema": {
    "type": "object",
    "properties": {
      "summary": {
        "type": "object",
        "properties": {
          "logsAnalyzed": { "type": "integer" },
          "anomaliesFound": { "type": "integer" },
          "severity": { "type": "string", "enum": ["LOW", "MEDIUM", "HIGH", "CRITICAL"] },
          "confidence": { "type": "string" },
          "timeWindow": { "type": "string" }
        }
      },
      "anomalies": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "type": { "type": "string" },
            "count": { "type": "integer" },
            "severity": { "type": "string" },
            "description": { "type": "string" },
            "recommendation": { "type": "string" }
          }
        }
      },
      "statistics": {
        "type": "object",
        "properties": {
          "uniqueIPs": { "type": "integer" },
          "uniquePaths": { "type": "integer" },
          "suspiciousIPs": { "type": "integer" },
          "suspiciousPaths": { "type": "integer" }
        }
      }
    }
  },
  "examples": [
    {
      "name": "Analyze Sample Logs",
      "description": "Analyze a sample of logs for security threats",
      "input": {
        "logs": [
          {
            "timestamp": "2025-10-24T10:15:23Z",
            "clientIP": "192.168.1.100",
            "path": "/admin/../../../etc/passwd",
            "method": "GET",
            "statusCode": 403,
            "userAgent": "curl/7.68.0",
            "country": "US",
            "asn": "AS15169"
          }
        ],
        "timeWindow": "10m"
      }
    }
  ]
}
